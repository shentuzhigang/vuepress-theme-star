"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2664],{76514:(n,e,s)=>{s.r(e),s.d(e,{data:()=>a});const a={key:"v-7de3cd45",path:"/vuepress-next/advanced/cookbook/usage-of-client-app-enhance.html",title:"Usage of Client App Enhance",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"Register Vue Components",slug:"register-vue-components",children:[]},{level:2,title:"Use Non-SSR-Friendly Features",slug:"use-non-ssr-friendly-features",children:[]},{level:2,title:"Use Router Methods",slug:"use-router-methods",children:[]}],git:{updatedTime:1635758933e3,contributors:[{name:"shentuzhigang",email:"shentuzhigang@moresec.cn",commits:1}]},readingTime:{minutes:1.56,words:469},filePathRelative:"vuepress-next/advanced/cookbook/usage-of-client-app-enhance.md",content:"# Usage of Client App Enhance\n\nThe [clientAppEnhanceFiles](../../reference/plugin-api.md#clientappenhancefiles) hook of Plugin API allows you to set the path to the client app enhance files. You can use it in your plugin or theme:\n\n```ts\nimport { path } from '@vuepress/utils'\n\nconst pluginOrTheme = {\n  clientAppEnhanceFiles: path.resolve(__dirname, './path/to/clientAppEnhance.ts'),\n}\n```\n\nThen create a `clientAppEnhance.ts` file. You can make use of the [defineClientAppEnhance](../../reference/client-api.md#defineclientappenhance) helper to get the types hint. Notice that the function can be either synchronous or asynchronous.\n\n```ts\nimport { defineClientAppEnhance } from '@vuepress/client'\n\nexport default defineClientAppEnhance(({ app, router, siteData }) => {\n  // ...\n})\n```\n\n- The `app` is the Vue application instance that created by [createApp](https://v3.vuejs.org/api/application-api.html).\n- The `router` is the Vue Router instance that created by [createRouter](https://next.router.vuejs.org/api/#createrouter).\n- The `siteData` is an object that generated from user config, including [base](../../reference/config.md#base), [lang](../../reference/config.md#lang), [title](../../reference/config.md#title), [description](../../reference/config.md#description), [head](../../reference/config.md#head) and [locales](../../reference/config.md#locales).\n\nThe client app enhance will be invoked after the client app is created. It's possible to implement any enhancements to the Vue application.\n\n::: tip\nFor ease of use in user config, the `.vuepress/clientAppEnhance.{js,ts}` file will be used as the client app enhance file implicitly, unless you set `clientAppEnhanceFiles` explicitly in the config file.\n:::\n\n## Register Vue Components\n\nYou can register global Vue components via the [component](https://v3.vuejs.org/api/application-api.html#component) method:\n\n```ts\nimport { defineClientAppEnhance } from '@vuepress/client'\nimport MyComponent from './MyComponent.vue'\n\nexport default defineClientAppEnhance(({ app, router, siteData }) => {\n  app.component('MyComponent', MyComponent)\n})\n```\n\n## Use Non-SSR-Friendly Features\n\nVuePress will generate a SSR application to pre-render pages during build. Generally speaking, if a code snippet is using Browser / DOM APIs before client app is mounted, we call it non-SSR-friendly.\n\nWe already provides a [ClientOnly](../../reference/components.md#clientonly) component to wrap non-SSR-friendly content.\n\nIn client app enhance files, you can make use of the [`__VUEPRESS_SSR__`](../../reference/client-api.md#ssr) flag for that purpose.\n\n```ts\nimport { defineClientAppEnhance } from '@vuepress/client'\n\nexport default defineClientAppEnhance(async ({ app, router, siteData }) => {\n  if (!__VUEPRESS_SSR__) {\n    const nonSsrFriendlyModule = await import('non-ssr-friendly-module')\n    // ...\n  }\n})\n```\n\n## Use Router Methods\n\nYou can make use of the [Router Methods](https://next.router.vuejs.org/api/#router-methods) that provided by vue-router. For example, add navigation guard:\n\n```ts\nimport { defineClientAppEnhance } from '@vuepress/client'\n\nexport default defineClientAppEnhance(({ app, router, siteData }) => {\n  router.beforeEach((to) => {\n    console.log('before navigation')\n  })\n\n  router.afterEach((to) => {\n    console.log('after navigation')\n  })\n})\n```\n\n::: warning\nIt's not recommended to use `addRoute` method to add dynamic routes here, because those routes will **NOT** be pre-rendered in build mode.\n\nBut you can still do that if you understand the drawback.\n:::\n"}},53204:(n,e,s)=>{s.r(e),s.d(e,{default:()=>O});var a=s(66252);const l=(0,a._)("h1",{id:"usage-of-client-app-enhance",tabindex:"-1"},[(0,a._)("a",{class:"header-anchor",href:"#usage-of-client-app-enhance","aria-hidden":"true"},"#"),(0,a.Uk)(" Usage of Client App Enhance")],-1),p=(0,a.Uk)("The "),o=(0,a.Uk)("clientAppEnhanceFiles"),t=(0,a.Uk)(" hook of Plugin API allows you to set the path to the client app enhance files. You can use it in your plugin or theme:"),r=(0,a.uE)('<div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@vuepress/utils&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">pluginOrTheme</span><span style="color:#D4D4D4;"> = {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">clientAppEnhanceFiles:</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">path</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">resolve</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">__dirname</span><span style="color:#D4D4D4;">, </span><span style="color:#CE9178;">&#39;./path/to/clientAppEnhance.ts&#39;</span><span style="color:#D4D4D4;">),</span></span>\n<span class="line"><span style="color:#D4D4D4;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>',1),c=(0,a.Uk)("Then create a "),i=(0,a._)("code",null,"clientAppEnhance.ts",-1),D=(0,a.Uk)(" file. You can make use of the "),u=(0,a.Uk)("defineClientAppEnhance"),y=(0,a.Uk)(" helper to get the types hint. Notice that the function can be either synchronous or asynchronous."),d=(0,a.uE)('<div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defineClientAppEnhance</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@vuepress/client&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">default</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">defineClientAppEnhance</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">router</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">siteData</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;">// ...</span></span>\n<span class="line"><span style="color:#D4D4D4;">})</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div>',1),h=(0,a._)("li",null,[(0,a.Uk)("The "),(0,a._)("code",null,"app"),(0,a.Uk)(" is the Vue application instance that created by "),(0,a._)("a",{href:"https://v3.vuejs.org/api/application-api.html",target:"_blank",rel:"noopener noreferrer"},"createApp"),(0,a.Uk)(".")],-1),m=(0,a._)("li",null,[(0,a.Uk)("The "),(0,a._)("code",null,"router"),(0,a.Uk)(" is the Vue Router instance that created by "),(0,a._)("a",{href:"https://next.router.vuejs.org/api/#createrouter",target:"_blank",rel:"noopener noreferrer"},"createRouter"),(0,a.Uk)(".")],-1),C=(0,a.Uk)("The "),f=(0,a._)("code",null,"siteData",-1),b=(0,a.Uk)(" is an object that generated from user config, including "),g=(0,a.Uk)("base"),E=(0,a.Uk)(", "),v=(0,a.Uk)("lang"),k=(0,a.Uk)(", "),A=(0,a.Uk)("title"),_=(0,a.Uk)(", "),F=(0,a.Uk)("description"),U=(0,a.Uk)(", "),x=(0,a.Uk)("head"),S=(0,a.Uk)(" and "),w=(0,a.Uk)("locales"),R=(0,a.Uk)("."),T=(0,a.uE)('<p>The client app enhance will be invoked after the client app is created. It&#39;s possible to implement any enhancements to the Vue application.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>For ease of use in user config, the <code>.vuepress/clientAppEnhance.{js,ts}</code> file will be used as the client app enhance file implicitly, unless you set <code>clientAppEnhanceFiles</code> explicitly in the config file.</p></div><h2 id="register-vue-components" tabindex="-1"><a class="header-anchor" href="#register-vue-components" aria-hidden="true">#</a> Register Vue Components</h2><p>You can register global Vue components via the <a href="https://v3.vuejs.org/api/application-api.html#component" target="_blank" rel="noopener noreferrer">component</a> method:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defineClientAppEnhance</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@vuepress/client&#39;</span></span>\n<span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">MyComponent</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;./MyComponent.vue&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">default</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">defineClientAppEnhance</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">router</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">siteData</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">component</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;MyComponent&#39;</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">MyComponent</span><span style="color:#D4D4D4;">)</span></span>\n<span class="line"><span style="color:#D4D4D4;">})</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="use-non-ssr-friendly-features" tabindex="-1"><a class="header-anchor" href="#use-non-ssr-friendly-features" aria-hidden="true">#</a> Use Non-SSR-Friendly Features</h2><p>VuePress will generate a SSR application to pre-render pages during build. Generally speaking, if a code snippet is using Browser / DOM APIs before client app is mounted, we call it non-SSR-friendly.</p>',7),M=(0,a.Uk)("We already provides a "),V=(0,a.Uk)("ClientOnly"),P=(0,a.Uk)(" component to wrap non-SSR-friendly content."),W=(0,a.Uk)("In client app enhance files, you can make use of the "),j=(0,a._)("code",null,"__VUEPRESS_SSR__",-1),I=(0,a.Uk)(" flag for that purpose."),N=(0,a.uE)('<div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defineClientAppEnhance</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@vuepress/client&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">default</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">defineClientAppEnhance</span><span style="color:#D4D4D4;">(</span><span style="color:#569CD6;">async</span><span style="color:#D4D4D4;"> ({ </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">router</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">siteData</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#C586C0;">if</span><span style="color:#D4D4D4;"> (!</span><span style="color:#9CDCFE;">__VUEPRESS_SSR__</span><span style="color:#D4D4D4;">) {</span></span>\n<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">nonSsrFriendlyModule</span><span style="color:#D4D4D4;"> = </span><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">import</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;non-ssr-friendly-module&#39;</span><span style="color:#D4D4D4;">)</span></span>\n<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#6A9955;">// ...</span></span>\n<span class="line"><span style="color:#D4D4D4;">  }</span></span>\n<span class="line"><span style="color:#D4D4D4;">})</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="use-router-methods" tabindex="-1"><a class="header-anchor" href="#use-router-methods" aria-hidden="true">#</a> Use Router Methods</h2><p>You can make use of the <a href="https://next.router.vuejs.org/api/#router-methods" target="_blank" rel="noopener noreferrer">Router Methods</a> that provided by vue-router. For example, add navigation guard:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">defineClientAppEnhance</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@vuepress/client&#39;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">default</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">defineClientAppEnhance</span><span style="color:#D4D4D4;">(({ </span><span style="color:#9CDCFE;">app</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">router</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">siteData</span><span style="color:#D4D4D4;"> }) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">router</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">beforeEach</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">to</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;before navigation&#39;</span><span style="color:#D4D4D4;">)</span></span>\n<span class="line"><span style="color:#D4D4D4;">  })</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">router</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">afterEach</span><span style="color:#D4D4D4;">((</span><span style="color:#9CDCFE;">to</span><span style="color:#D4D4D4;">) </span><span style="color:#569CD6;">=&gt;</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">console</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">log</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;after navigation&#39;</span><span style="color:#D4D4D4;">)</span></span>\n<span class="line"><span style="color:#D4D4D4;">  })</span></span>\n<span class="line"><span style="color:#D4D4D4;">})</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>It&#39;s not recommended to use <code>addRoute</code> method to add dynamic routes here, because those routes will <strong>NOT</strong> be pre-rendered in build mode.</p><p>But you can still do that if you understand the drawback.</p></div>',5),Y={},O=(0,s(83744).Z)(Y,[["render",function(n,e){const s=(0,a.up)("RouterLink");return(0,a.wg)(),(0,a.iD)(a.HY,null,[l,(0,a._)("p",null,[p,(0,a.Wm)(s,{to:"/vuepress-next/reference/plugin-api.html#clientappenhancefiles"},{default:(0,a.w5)((()=>[o])),_:1}),t]),r,(0,a._)("p",null,[c,i,D,(0,a.Wm)(s,{to:"/vuepress-next/reference/client-api.html#defineclientappenhance"},{default:(0,a.w5)((()=>[u])),_:1}),y]),d,(0,a._)("ul",null,[h,m,(0,a._)("li",null,[C,f,b,(0,a.Wm)(s,{to:"/vuepress-next/reference/config.html#base"},{default:(0,a.w5)((()=>[g])),_:1}),E,(0,a.Wm)(s,{to:"/vuepress-next/reference/config.html#lang"},{default:(0,a.w5)((()=>[v])),_:1}),k,(0,a.Wm)(s,{to:"/vuepress-next/reference/config.html#title"},{default:(0,a.w5)((()=>[A])),_:1}),_,(0,a.Wm)(s,{to:"/vuepress-next/reference/config.html#description"},{default:(0,a.w5)((()=>[F])),_:1}),U,(0,a.Wm)(s,{to:"/vuepress-next/reference/config.html#head"},{default:(0,a.w5)((()=>[x])),_:1}),S,(0,a.Wm)(s,{to:"/vuepress-next/reference/config.html#locales"},{default:(0,a.w5)((()=>[w])),_:1}),R])]),T,(0,a._)("p",null,[M,(0,a.Wm)(s,{to:"/vuepress-next/reference/components.html#clientonly"},{default:(0,a.w5)((()=>[V])),_:1}),P]),(0,a._)("p",null,[W,(0,a.Wm)(s,{to:"/vuepress-next/reference/client-api.html#ssr"},{default:(0,a.w5)((()=>[j])),_:1}),I]),N],64)}]])}}]);